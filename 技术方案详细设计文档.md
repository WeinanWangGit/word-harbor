\# 技术方案详细设计文档（Technical Design Doc）



> 本文档用于指导 \*\*前端开发实习生\*\* 从 0 搭建系统。目标是：

> 

> - 不依赖业务背景也能看懂

>     

> - 按模块独立开发

>     

> - 能在 1–2 周内完成可运行 MVP

>     



---



\## 一、总体技术架构概览



\### 1.1 架构模式



\- \*\*纯前端 Web 应用（SPA）\*\*

&nbsp;   

\- 无后端、无登录

&nbsp;   

\- 本地状态 + 本地持久化

&nbsp;   



```

UI（React Components）

&nbsp;  ↓

State（全局状态管理）

&nbsp;  ↓

Persistence（localStorage）

```



---



\## 二、技术选型说明



\### 2.1 技术栈（必须）



|模块|技术|说明|

|---|---|---|

|框架|React 18|组件化、生态成熟|

|构建|Vite|快速、简单|

|语言|TypeScript|降低维护成本|

|路由|React Router|页面跳转|

|状态|Zustand|轻量全局状态|

|样式|Tailwind CSS|快速出效果|

|动画|CSS / Lottie|抽卡动画|

|存储|localStorage|用户数据|



> ❗不允许引入 Redux、后端、数据库



---



\## 三、项目目录结构（必须严格遵守）



```

src/

&nbsp;├─ assets/

&nbsp;│   ├─ images/          # 卡牌立绘、UI 图片

&nbsp;│   └─ audio/           # 单词发音（可选）

&nbsp;│

&nbsp;├─ data/

&nbsp;│   └─ cards.ts         # 单词卡静态数据

&nbsp;│

&nbsp;├─ pages/               # 页面级组件

&nbsp;│   ├─ Home.tsx

&nbsp;│   ├─ Gacha.tsx

&nbsp;│   ├─ Collection.tsx

&nbsp;│   └─ CardDetail.tsx

&nbsp;│

&nbsp;├─ components/          # 可复用组件

&nbsp;│   ├─ Card/

&nbsp;│   │   ├─ CardView.tsx

&nbsp;│   │   └─ CardFrame.tsx

&nbsp;│   ├─ Gacha/

&nbsp;│   │   ├─ GachaButton.tsx

&nbsp;│   │   └─ GachaAnimation.tsx

&nbsp;│   ├─ Modal/

&nbsp;│   │   └─ ResultModal.tsx

&nbsp;│   └─ Layout/

&nbsp;│       └─ BottomNav.tsx

&nbsp;│

&nbsp;├─ store/

&nbsp;│   └─ useUserStore.ts

&nbsp;│

&nbsp;├─ types/

&nbsp;│   └─ index.ts

&nbsp;│

&nbsp;├─ utils/

&nbsp;│   ├─ gacha.ts

&nbsp;│   └─ storage.ts

&nbsp;│

&nbsp;├─ App.tsx

&nbsp;└─ main.tsx

```



---



\## 四、核心数据结构定义（Types）



\### 4.1 单词卡 Card



```ts

export interface Card {

&nbsp; id: string;              // 唯一 ID

&nbsp; word: string;            // 英文单词 / 表达

&nbsp; rarity: 1 | 2 | 3 | 4;    // 稀有度

&nbsp; description: string;     // 使用说明（非直译）

&nbsp; examples: string\[];      // 情境句

&nbsp; image: string;           // 立绘路径

&nbsp; audio?: string;          // 发音路径（可选）

}

```



---



\### 4.2 用户状态 UserState



```ts

export interface UserState {

&nbsp; ownedCardIds: string\[];                  // 已拥有卡牌

&nbsp; masteryMap: Record<string, number>;      // 卡牌掌握度

&nbsp; dailyGachaRemaining: number;             // 今日剩余抽卡

&nbsp; lastLoginDate: string;                   // 用于重置抽卡次数

}

```



---



\## 五、全局状态管理（Zustand）



\### 5.1 Store 职责



\- 管理用户卡牌数据

&nbsp;   

\- 管理抽卡次数

&nbsp;   

\- 同步 localStorage

&nbsp;   



\### 5.2 useUserStore.ts 示例结构



```ts

create<UserState \& Actions>((set, get) => ({

&nbsp; ownedCardIds: \[],

&nbsp; masteryMap: {},

&nbsp; dailyGachaRemaining: 3,

&nbsp; lastLoginDate: '',



&nbsp; addCard: (cardId) => {},

&nbsp; increaseMastery: (cardId) => {},

&nbsp; consumeGacha: () => {},

&nbsp; resetDailyGachaIfNeeded: () => {}

}))

```



> ❗所有页面只能通过 store 修改数据



---



\## 六、抽卡系统实现方案



\### 6.1 抽卡权重设计



```ts

const rarityWeights = {

&nbsp; 1: 60,

&nbsp; 2: 25,

&nbsp; 3: 10,

&nbsp; 4: 5,

};

```



\### 6.2 抽卡流程（gacha.ts）



```

检查剩余抽卡次数

&nbsp;→ 按权重随机稀有度

&nbsp;→ 在对应稀有度卡池中随机一张

&nbsp;→ 返回 Card

```



---



\## 七、页面级实现说明



\### 7.1 Home.tsx（首页）



职责：



\- 展示剩余抽卡次数

&nbsp;   

\- 展示随机已拥有卡牌

&nbsp;   



不允许：



\- 抽卡逻辑

&nbsp;   



---



\### 7.2 Gacha.tsx（抽卡页）



职责：



\- 触发抽卡

&nbsp;   

\- 播放动画

&nbsp;   

\- 打开 ResultModal

&nbsp;   



---



\### 7.3 ResultModal.tsx



职责：



\- 展示抽到的卡牌

&nbsp;   

\- 点击进入 CardDetail

&nbsp;   



---



\### 7.4 CardDetail.tsx（核心）



职责：



\- 展示卡牌信息

&nbsp;   

\- 提供一个互动题

&nbsp;   

\- 正确后调用 increaseMastery

&nbsp;   



> ❗这里是“学习唯一发生的地方”



---



\### 7.5 Collection.tsx（图鉴）



职责：



\- 网格展示所有卡牌

&nbsp;   

\- 未拥有 → 剪影

&nbsp;   



---



\## 八、本地存储方案



\### 8.1 存储策略



\- store 初始化时从 localStorage 读取

&nbsp;   

\- 每次 state 变化自动写入

&nbsp;   



\### 8.2 storage.ts



```ts

export const loadState = () => {};

export const saveState = (state) => {};

```



---



\## 九、开发顺序建议（实习生必看）



1\. 项目初始化（Vite + React + TS）

&nbsp;   

2\. 路由 + 页面空壳

&nbsp;   

3\. cards.ts 静态数据

&nbsp;   

4\. 抽卡逻辑（无 UI）

&nbsp;   

5\. Store + localStorage

&nbsp;   

6\. 抽卡 UI

&nbsp;   

7\. 卡牌详情页互动

&nbsp;   

8\. 图鉴页

&nbsp;   



---



\## 十、代码规范要求



\- 所有组件必须是函数组件

&nbsp;   

\- 不允许直接操作 localStorage

&nbsp;   

\- 不允许在组件内写随机逻辑

&nbsp;   

\- 命名清晰，不允许 a/b/c

&nbsp;   



---



\## 十一、验收标准（Definition of Done）



\- 可抽卡

&nbsp;   

\- 抽卡次数每日重置

&nbsp;   

\- 卡牌可查看

&nbsp;   

\- 至少 1 种互动生效

&nbsp;   

\- 刷新页面数据不丢失

&nbsp;   



---



\## 十二、开发边界（严禁扩展）



\- ❌ 不允许加登录

&nbsp;   

\- ❌ 不允许加后端

&nbsp;   

\- ❌ 不允许加排行榜

&nbsp;   

\- ❌ 不允许复杂动画系统

&nbsp;   



---



\## 十三、总结（给开发者的话）



这是一个 \*\*体验驱动而非功能驱动\*\* 的项目。



请优先保证：



> 抽卡顺畅 + 卡牌好看 + 数据不丢



其他都不是第一优先级。

